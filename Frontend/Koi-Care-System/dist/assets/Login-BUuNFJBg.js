import{r as h,h as q,u as Z,j as s,T as z,L as O,B as M,a as B}from"./index-DsR5MBtH.js";import{u as G,g as V,a as W}from"./index.esm-XLeKDvWu.js";import{P as u}from"./index-BKN4LrXa.js";import{F as $}from"./index-gO7psG0g.js";import{b as K}from"./0917(1)-C6vz000w.js";import{I as Q}from"./InputAdornment-D4oGorCC.js";import"./Typography-BGxL3EC8.js";var X=function(r){var a=r.as,o=r.errors,t=r.name,e=r.message,d=r.render,f=function(n,c){if(n==null)return{};var l,v,w={},j=Object.keys(n);for(v=0;v<j.length;v++)c.indexOf(l=j[v])>=0||(w[l]=n[l]);return w}(r,["as","errors","name","message","render"]),y=G(),x=V(o||y.formState.errors,t);if(!x)return null;var p=x.message,m=x.types,i=Object.assign({},f,{children:p||e});return h.isValidElement(a)?h.cloneElement(a,i):d?d({message:p||e,messages:m}):h.createElement(a||h.Fragment,i)},J=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function E(){return E=Object.assign?Object.assign.bind():function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(r[t]=o[t])}return r},E.apply(this,arguments)}function Y(r,a){if(r==null)return{};var o={},t=Object.keys(r),e,d;for(d=0;d<t.length;d++)e=t[d],!(a.indexOf(e)>=0)&&(o[e]=r[e]);return o}function S(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ee(r,a){r.prototype=Object.create(a.prototype),r.prototype.constructor=r,I(r,a)}function I(r,a){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(r,a)}var N=function(r){ee(a,r);function a(){var t;return t=r.call(this)||this,t.handleExpired=t.handleExpired.bind(S(t)),t.handleErrored=t.handleErrored.bind(S(t)),t.handleChange=t.handleChange.bind(S(t)),t.handleRecaptchaRef=t.handleRecaptchaRef.bind(S(t)),t}var o=a.prototype;return o.getCaptchaFunction=function(e){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[e]:this.props.grecaptcha[e]:null},o.getValue=function(){var e=this.getCaptchaFunction("getResponse");return e&&this._widgetId!==void 0?e(this._widgetId):null},o.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},o.execute=function(){var e=this.getCaptchaFunction("execute");if(e&&this._widgetId!==void 0)return e(this._widgetId);this._executeRequested=!0},o.executeAsync=function(){var e=this;return new Promise(function(d,f){e.executionResolve=d,e.executionReject=f,e.execute()})},o.reset=function(){var e=this.getCaptchaFunction("reset");e&&this._widgetId!==void 0&&e(this._widgetId)},o.forceReset=function(){var e=this.getCaptchaFunction("reset");e&&e()},o.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},o.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},o.handleChange=function(e){this.props.onChange&&this.props.onChange(e),this.executionResolve&&(this.executionResolve(e),delete this.executionReject,delete this.executionResolve)},o.explicitRender=function(){var e=this.getCaptchaFunction("render");if(e&&this._widgetId===void 0){var d=document.createElement("div");this._widgetId=e(d,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(d)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},o.componentDidMount=function(){this.explicitRender()},o.componentDidUpdate=function(){this.explicitRender()},o.handleRecaptchaRef=function(e){this.captcha=e},o.render=function(){var e=this.props;e.sitekey,e.onChange,e.theme,e.type,e.tabindex,e.onExpired,e.onErrored,e.size,e.stoken,e.grecaptcha,e.badge,e.hl,e.isolated;var d=Y(e,J);return h.createElement("div",E({},d,{ref:this.handleRecaptchaRef}))},a}(h.Component);N.displayName="ReCAPTCHA";N.propTypes={sitekey:u.string.isRequired,onChange:u.func,grecaptcha:u.object,theme:u.oneOf(["dark","light"]),type:u.oneOf(["image","audio"]),tabindex:u.number,onExpired:u.func,onErrored:u.func,size:u.oneOf(["compact","normal","invisible"]),stoken:u.string,hl:u.string,badge:u.oneOf(["bottomright","bottomleft","inline"]),isolated:u.bool};N.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};function C(){return C=Object.assign||function(r){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(r[t]=o[t])}return r},C.apply(this,arguments)}function te(r,a){if(r==null)return{};var o={},t=Object.keys(r),e,d;for(d=0;d<t.length;d++)e=t[d],!(a.indexOf(e)>=0)&&(o[e]=r[e]);return o}function re(r,a){r.prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a}var b={},ne=0;function ae(r,a){return a=a||{},function(t){var e=t.displayName||t.name||"Component",d=function(y){re(x,y);function x(m,i){var n;return n=y.call(this,m,i)||this,n.state={},n.__scriptURL="",n}var p=x.prototype;return p.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+ne++),this.__scriptLoaderID},p.setupScriptURL=function(){return this.__scriptURL=typeof r=="function"?r():r,this.__scriptURL},p.asyncScriptLoaderHandleLoad=function(i){var n=this;this.setState(i,function(){return n.props.asyncScriptOnLoad&&n.props.asyncScriptOnLoad(n.state)})},p.asyncScriptLoaderTriggerOnScriptLoaded=function(){var i=b[this.__scriptURL];if(!i||!i.loaded)throw new Error("Script is not loaded.");for(var n in i.observers)i.observers[n](i);delete window[a.callbackName]},p.componentDidMount=function(){var i=this,n=this.setupScriptURL(),c=this.asyncScriptLoaderGetScriptLoaderID(),l=a,v=l.globalName,w=l.callbackName,j=l.scriptId;if(v&&typeof window[v]<"u"&&(b[n]={loaded:!0,observers:{}}),b[n]){var _=b[n];if(_&&(_.loaded||_.errored)){this.asyncScriptLoaderHandleLoad(_);return}_.observers[c]=function(g){return i.asyncScriptLoaderHandleLoad(g)};return}var U={};U[c]=function(g){return i.asyncScriptLoaderHandleLoad(g)},b[n]={loaded:!1,observers:U};var R=document.createElement("script");R.src=n,R.async=!0;for(var F in a.attributes)R.setAttribute(F,a.attributes[F]);j&&(R.id=j);var T=function(L){if(b[n]){var H=b[n],k=H.observers;for(var D in k)L(k[D])&&delete k[D]}};w&&typeof window<"u"&&(window[w]=function(){return i.asyncScriptLoaderTriggerOnScriptLoaded()}),R.onload=function(){var g=b[n];g&&(g.loaded=!0,T(function(L){return w?!1:(L(g),!0)}))},R.onerror=function(){var g=b[n];g&&(g.errored=!0,T(function(L){return L(g),!0}))},document.body.appendChild(R)},p.componentWillUnmount=function(){var i=this.__scriptURL;if(a.removeOnUnmount===!0)for(var n=document.getElementsByTagName("script"),c=0;c<n.length;c+=1)n[c].src.indexOf(i)>-1&&n[c].parentNode&&n[c].parentNode.removeChild(n[c]);var l=b[i];l&&(delete l.observers[this.asyncScriptLoaderGetScriptLoaderID()],a.removeOnUnmount===!0&&delete b[i])},p.render=function(){var i=a.globalName,n=this.props;n.asyncScriptOnLoad;var c=n.forwardedRef,l=te(n,["asyncScriptOnLoad","forwardedRef"]);return i&&typeof window<"u"&&(l[i]=typeof window[i]<"u"?window[i]:void 0),l.ref=c,h.createElement(t,l)},x}(h.Component),f=h.forwardRef(function(y,x){return h.createElement(d,C({},y,{forwardedRef:x}))});return f.displayName="AsyncScriptLoader("+e+")",f.propTypes={asyncScriptOnLoad:u.func},q(f,t)}}var P="onloadcallback",oe="grecaptcha";function A(){return typeof window<"u"&&window.recaptchaOptions||{}}function se(){var r=A(),a=r.useRecaptchaNet?"recaptcha.net":"www.google.com";return r.enterprise?"https://"+a+"/recaptcha/enterprise.js?onload="+P+"&render=explicit":"https://"+a+"/recaptcha/api.js?onload="+P+"&render=explicit"}const ie=ae(se,{callbackName:P,globalName:oe,attributes:A().nonce?{nonce:A().nonce}:{}})(N);function me(){const[r,a]=h.useState(!1),[o,t]=h.useState(!1),[e,d]=h.useState(null),f=Z();h.useEffect(()=>{(async()=>{const n=new URLSearchParams(window.location.search),c=n.get("token"),l=n.get("role"),v=n.get("id"),w=n.get("username"),j=n.get("avatar");console.log(c),console.log(v),console.log(w),console.log(j),c&&(localStorage.setItem("token",c),localStorage.setItem("role",l),localStorage.setItem("id",v),localStorage.setItem("name",w),localStorage.setItem("avt",j),f("/member/dashboard"))})()},[f]);const{register:y,handleSubmit:x,formState:{errors:p}}=W(),m=async i=>{if(t(!0),!e){M.warn("Please complete reCAPTCHA"),t(!1);return}try{const c=(await B.post("https://koicaresystemv2.azurewebsites.net/api/auth/loginKoiCare",{username:i.username,password:i.password})).data.data;if(c&&c.token)switch(localStorage.setItem("token",c.token),localStorage.setItem("role",c.role),localStorage.setItem("id",c.id),localStorage.setItem("name",c.username),localStorage.setItem("avt",c.avatar),c.role){case"ADMIN":f("/admin/dashboard");break;case"SHOP":f("/shop/dashboard");break;case"MEMBER":f("/member/dashboard");break;default:break}}catch(n){M.error("Invalid username or password"),console.log(n)}finally{t(!1)}};return s.jsxs("div",{className:"h-screen flex flex-col items-center justify-center",children:[s.jsx("video",{className:"absolute top-0 left-0 w-full h-full object-cover",src:K,autoPlay:!0,loop:!0,muted:!0}),s.jsxs("div",{className:"absolute bg-white p-8 rounded-3xl shadow-md w-full max-w-md bg-opacity-30 backdrop-blur-0 border border-gray-300",children:[s.jsx("h2",{className:"text-black text-5xl font-bold mb-6 text-center",children:"Login"}),s.jsxs("form",{className:"relative",onSubmit:x(m),noValidate:!0,children:[s.jsx("div",{className:"mb-4 relative",children:s.jsx(z,{id:"username",label:"Username",variant:"outlined",...y("username",{required:"Name is required"}),error:!!p.username,helperText:p.username?p.username.message:"",className:"w-full p-3 "})}),s.jsxs("div",{className:"mb-4 relative",children:[s.jsx(z,{id:"password",type:r?"text":"password",label:"Password",variant:"outlined",...y("password",{required:"Password is required"}),error:!!p.password,InputProps:{endAdornment:s.jsx(Q,{position:"end",children:s.jsx("span",{className:"cursor-pointer text-gray-300",onClick:()=>a(!r),children:r?s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:s.jsx("path",{d:"M12 4.5C5.25 4.5 1.5 12 1.5 12s3.75 7.5 10.5 7.5S22.5 12 22.5 12 18.75 4.5 12 4.5Zm0 12a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9Zm0-7.5a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"})}):s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:[s.jsx("path",{d:"M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z"}),s.jsx("path",{d:"M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z"}),s.jsx("path",{d:"M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z"})]})})})},className:"w-full p-3 bg-gray-700 bg-transparent"}),s.jsx(X,{errors:p,name:"password",as:"p",className:"text-red-500 text-sm"})]}),s.jsx(ie,{sitekey:"6Lf_-EUqAAAAACdtnX38OBQj-ok8Kt51EPQQ5cxy",onChange:i=>d(i)}),s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("label",{className:"inline-flex items-center text-gray-400",children:[s.jsx("input",{type:"checkbox",className:"form-checkbox text-blue-500 rounded"}),s.jsx("span",{className:"ml-2 text-black font-bold",children:"Remember me"})]}),s.jsx(O,{to:"/email",className:"text-black font-bold cursor-pointer mt-2",children:"Forgot password?"})]}),s.jsx("button",{className:`w-full flex items-center justify-center bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-semibold ${o?"opacity-50 cursor-not-allowed":""}`,disabled:o&&!e,children:s.jsxs("div",{className:"flex items-center space-x-2",children:[o&&s.jsx($,{className:"animate-spin"}),s.jsx("span",{children:"Sign in"})]})})]}),s.jsxs("div",{className:"flex items-center mb-2 mt-2",children:[s.jsx("div",{className:"flex-1 h-1 w-1 bg-gray-300"}),s.jsx("div",{className:"text-gray-400 font-bold text-lg px-3",children:"or"}),s.jsx("div",{className:"flex-1 h-1 w-1 bg-gray-300"})]}),s.jsx("div",{className:"flex items-center justify-between mt-2",children:s.jsxs(O,{to:"https://koicaresystemv2.azurewebsites.net/api/oauth2/authorization/google?redirect_uri=https://koi-care-system.vercel.app/member/dashboard",className:"flex items-center justify-center bg-white border hover:bg-gray-100 border-gray-300 text-gray-800 w-full py-3 rounded-lg mr-2",children:[s.jsx("img",{src:"https://www.google.com/favicon.ico",alt:"Google",className:"h-5 mr-2"}),"Sign in with Google"]})}),s.jsxs("div",{className:"text-black font-bold mt-2 text-center",children:["Do not have an account?",s.jsx(O,{to:"/register",className:"text-red-500 ml-1 font-bold",children:"Sign up"})]})]})]})}export{me as default};
